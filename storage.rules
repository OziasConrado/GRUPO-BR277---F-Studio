
rules_version = '2';

service firebase.storage {
  match /b/{bucket}/o {
    
    // As imagens, vídeos e áudios são públicos para leitura por padrão neste app.
    // Em um cenário com dados sensíveis, a leitura também seria restrita.
    match /{allPaths=**} {
      allow read: if true;
    }

    // Regras para Fotos de Perfil (max 2MB)
    match /profile_pictures/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId
                    && request.resource.size < 2 * 1024 * 1024
                    && request.resource.contentType.matches('image/.*');
    }

    // Regras para Imagens do Feed (max 5MB)
    match /images/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId
                    && request.resource.size < 5 * 1024 * 1024
                    && request.resource.contentType.matches('image/.*');
    }

    // Regras para Vídeos do Feed (max 50MB)
    match /videos/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId
                    && request.resource.size < 50 * 1024 * 1024
                    && request.resource.contentType.matches('video/.*');
    }
    
    // Regras para Imagens do Chat (max 5MB)
    match /chat_images/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId
                    && request.resource.size < 5 * 1024 * 1024
                    && request.resource.contentType.matches('image/.*');
    }

    // Regras para Áudio do Chat (max 10MB)
    match /chat_audio/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId
                    && request.resource.size < 10 * 1024 * 1024
                    && request.resource.contentType.matches('audio/.*');
    }
    
    // Regras para Imagens de Pontos Turísticos Indicados (max 2MB)
    match /indicated_points_images/{userId}/{fileName} {
      allow write: if request.auth != null && request.auth.uid == userId
                    && request.resource.size < 2 * 1024 * 1024
                    && request.resource.contentType.matches('image/.*');
    }
  }
}
